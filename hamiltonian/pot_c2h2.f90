subroutine poten_c2h2_7coords_ADF(molec, func, internal, f, cart)
  use adf
  implicit none

  type(HM_molec_type), intent(in) :: molec
  type(HM_func_type), intent(in)  :: func
  type(adf_realq), intent(in)     :: internal(molec%nmodes)
  type(adf_realq), intent(out)    :: f(func%rank)
  type(adf_realq), intent(in), optional :: cart(molec%natoms,3)

  integer(ik), parameter :: nparams = 578
  integer(ik) :: irank
  real(ark) :: e1, e2, a1, a2
  type(adf_realq) :: r0, r1, r2, y1, y2, y3, y4, y5, y6, y7, qx1, qx2, qy1, qy2, dF(nparams)

  irank = 1

  if (nparams<func%nparams(irank)) then
    write(out, '(/a,1x,i6)') 'poten_c2h2_7coords_ADF error: number of input parameters for PES exceeds the maximal value =', nparams
    stop
  endif

  ! internal coordinates

  if (trim(molec%coord_transform)=='C2H2_RQXQY') then

    r0    = internal(1)
    r1    = internal(2)
    r2    = internal(3)
    qx1   = internal(4)
    qy1   = internal(5)
    qx2   = internal(6)
    qy2   = internal(7)

  else

    write(out, '(/a,a,a)') 'poten_c2h2_7coords_ADF error: coordinate type = "', trim(molec%coord_transform), '" is not supported'
    stop

  endif

  ! expansion functions

  e1 = func%params(1,irank)
  e2 = func%params(2,irank)
  a1 = func%params(3,irank)
  a2 = func%params(4,irank)

  y1 = 1.0_ark-exp(-a1*(r0-e1))
  y2 = 1.0_ark-exp(-a2*(r1-e2))
  y3 = 1.0_ark-exp(-a2*(r2-e2))
  y4 = qx1
  y5 = qy1
  y6 = qx2
  y7 = qy2

  ! potential

  dF(1:4) = 0.0_ark

      dF(5) = 1.0_ark
      dF(6) = y3+y2
      dF(7) = y1
      dF(8) = y6**2+y5**2+y4**2+y7**2
      dF(9) = y5*y7+y4*y6
      dF(10) = y2**2+y3**2
      dF(11) = y2*y3
      dF(12) = (y3+y2)*y1
      dF(13) = y1**2
      dF(14) = (y7**2+y6**2)*y2+(y4**2+y5**2)*y3
      dF(15) = (y5*y7+y4*y6)*y2+(y5*y7+y4*y6)*y3
      dF(16) = (y4**2+y5**2)*y2+(y7**2+y6**2)*y3
      dF(17) = y2*y3**2+y2**2*y3
      dF(18) = y2**3+y3**3
      dF(19) = (y5*y7+y4*y6)*y1
      dF(20) = (y7**2+y5**2+y6**2+y4**2)*y1
      dF(21) = y1*y2*y3
      dF(22) = (y3**2+y2**2)*y1
      dF(23) = (y3+y2)*y1**2
      dF(24) = y1**3
      dF(25) = y7**4+y5**4+y6**4+y4**4
      dF(26) = y4*y5*y6*y7
      dF(27) = y4**2*y7**2+y5**2*y6**2
      dF(28) = y4**2*y6**2+y5**2*y7**2
      dF(29) = y4**2*y5*y7+(y5**2*y6+y6*y7**2)*y4+y5*y6**2*y7
      dF(30) = y4**2*y5**2+y6**2*y7**2
      dF(31) = y4**3*y6+y5*y7**3+y4*y6**3+y5**3*y7
      dF(32) = (y4**2+y5**2)*y2**2+(y6**2+y7**2)*y3**2
      dF(33) = (y4*y6+y5*y7)*y2**2+(y4*y6+y5*y7)*y3**2
      dF(34) = (y6**2+y7**2)*y2**2+(y4**2+y5**2)*y3**2
      dF(35) = y3**4+y2**4
      dF(36) = (y4*y6+y5*y7)*y3*y2
      dF(37) = (y4**2+y5**2+y6**2+y7**2)*y3*y2
      dF(38) = y2**2*y3**2
      dF(39) = y2**3*y3+y2*y3**3
      dF(40) = ((y6**2+y7**2)*y2+(y4**2+y5**2)*y3)*y1
      dF(41) = ((y4*y6+y5*y7)*y2+(y4*y6+y5*y7)*y3)*y1
      dF(42) = ((y4**2+y5**2)*y2+(y6**2+y7**2)*y3)*y1
      dF(43) = (y2**2*y3+y2*y3**2)*y1
      dF(44) = (y2**3+y3**3)*y1
      dF(45) = (y4*y6+y5*y7)*y1**2
      dF(46) = (y4**2+y5**2+y6**2+y7**2)*y1**2
      dF(47) = y1**2*y2*y3
      dF(48) = (y2**2+y3**2)*y1**2
      dF(49) = (y2+y3)*y1**3
      dF(50) = y1**4
      dF(51) = y2*y4**2*y5**2+y3*y6**2*y7**2
      dF(52) = (y5**4+y4**4)*y2+(y7**4+y6**4)*y3
      dF(53) = (y4**3*y6+y5**3*y7)*y2+(y4*y6**3+y5*y7**3)*y3
      dF(54) = (y4**2*y5*y7+y4*y5**2*y6)*y2+(y4*y6*y7**2+y5*y6**2*y7)*y3
      dF(55) = (y4**2*y6**2+y5**2*y7**2)*y2+(y4**2*y6**2+y5**2*y7**2)*y3
      dF(56) = (y5**2*y6**2+y4**2*y7**2)*y2+(y5**2*y6**2+y4**2*y7**2)*y3
      dF(57) = (y4**2+y5**2)*y2**3+(y6**2+y7**2)*y3**3
      dF(58) = (y5*y7+y4*y6)*y2**3+(y5*y7+y4*y6)*y3**3
      dF(59) = (y6**2+y7**2)*y2**3+(y4**2+y5**2)*y3**3
      dF(60) = y3**5+y2**5
      dF(61) = y2*y6**2*y7**2+y3*y4**2*y5**2
      dF(62) = (y7**4+y6**4)*y2+(y5**4+y4**4)*y3
      dF(63) = (y4*y6*y7**2+y5*y6**2*y7)*y2+(y4**2*y5*y7+y4*y5**2*y6)*y3
      dF(64) = (y4*y6**3+y5*y7**3)*y2+(y4**3*y6+y5**3*y7)*y3
      dF(65) = y2*y4*y5*y6*y7+y3*y4*y5*y6*y7
      dF(66) = (y4**2+y5**2)*y3*y2**2+(y6**2+y7**2)*y3**2*y2
      dF(67) = (y5*y7+y4*y6)*y3*y2**2+(y5*y7+y4*y6)*y3**2*y2
      dF(68) = (y6**2+y7**2)*y3*y2**2+(y4**2+y5**2)*y3**2*y2
      dF(69) = y2*y3**4+y2**4*y3
      dF(70) = y2**3*y3**2+y2**2*y3**3
      dF(71) = y1*y4*y5*y6*y7
      dF(72) = (y5**2*y6**2+y4**2*y7**2)*y1
      dF(73) = (y4**2*y6**2+y5**2*y7**2)*y1
      dF(74) = (y4**2*y5*y7+(y6*y7**2+y5**2*y6)*y4+y5*y6**2*y7)*y1
      dF(75) = (y6**2*y7**2+y4**2*y5**2)*y1
      dF(76) = (y5*y7**3+y4*y6**3+y5**3*y7+y4**3*y6)*y1
      dF(77) = (y5**4+y7**4+y6**4+y4**4)*y1
      dF(78) = (y5*y7+y4*y6)*y3*y2*y1
      dF(79) = (y5**2+y7**2+y6**2+y4**2)*y3*y2*y1
      dF(80) = ((y6**2+y7**2)*y2**2+(y4**2+y5**2)*y3**2)*y1
      dF(81) = ((y5*y7+y4*y6)*y2**2+(y5*y7+y4*y6)*y3**2)*y1
      dF(82) = ((y4**2+y5**2)*y2**2+(y6**2+y7**2)*y3**2)*y1
      dF(83) = y1*y2**2*y3**2
      dF(84) = (y2**3*y3+y2*y3**3)*y1
      dF(85) = (y2**4+y3**4)*y1
      dF(86) = ((y6**2+y7**2)*y2+(y4**2+y5**2)*y3)*y1**2
      dF(87) = ((y5*y7+y4*y6)*y2+(y5*y7+y4*y6)*y3)*y1**2
      dF(88) = ((y4**2+y5**2)*y2+(y6**2+y7**2)*y3)*y1**2
      dF(89) = (y2**2*y3+y2*y3**2)*y1**2
      dF(90) = (y2**3+y3**3)*y1**2
      dF(91) = (y5*y7+y4*y6)*y1**3
      dF(92) = (y5**2+y7**2+y6**2+y4**2)*y1**3
      dF(93) = y1**3*y2*y3
      dF(94) = (y3**2+y2**2)*y1**3
      dF(95) = (y2+y3)*y1**4
      dF(96) = y1**5
      dF(97) = y7**6+y4**6+y6**6+y5**6
      dF(98) = y6**2*y7**4+y4**2*y5**4+y4**4*y5**2+y6**4*y7**2
      dF(99) = y5*y6**2*y7**3+y4**2*y5**3*y7+y4**3*y5**2*y6+y4*y6**3*y7**2
      dF(100) = y5**2*y6**4+y4**4*y7**2+y5**4*y6**2+y4**2*y7**4
      dF(101) = y5**3*y7**3+y4**3*y6**3
      dF(102) = y5**3*y6**2*y7+y4**2*y5*y7**3+y4**3*y6*y7**2+y4*y5**2*y6**3
      dF(103) = y5**4*y7**2+y4**2*y6**4+y4**4*y6**2+y5**2*y7**4
      dF(104) = y5**5*y7+y4**5*y6+y4*y6**5+y5*y7**5
      dF(105) = y4*y5**2*y6*y7**2+y4**2*y5*y6**2*y7
      dF(106) = y4**4*y5*y7+(y5**4*y6+y6*y7**4)*y4+y5*y6**4*y7
      dF(107) = ((y6**2+y7**2)*y5**2+y6**2*y7**2)*y4**2+y5**2*y6**2*y7**2
      dF(108) = y4**3*y5*y6*y7+(y5**3*y6*y7+(y6*y7**3+y6**3*y7)*y5)*y4
      dF(109) = (y4**2+y5**2)*y2**4+(y6**2+y7**2)*y3**4
      dF(110) = (y6**2+y7**2)*y2**4+(y4**2+y5**2)*y3**4
      dF(111) = (y5*y7+y4*y6)*y2**4+(y5*y7+y4*y6)*y3**4
      dF(112) = y3**6+y2**6
      dF(113) = (y7**4+y6**4+y4**4+y5**4)*y3*y2
      dF(114) = (y6**2*y7**2+y4**2*y5**2)*y3*y2
      dF(115) = (y5*y7**3+y4*y6**3+y4**3*y6+y5**3*y7)*y3*y2
      dF(116) = (y4**2*y5*y7+(y6*y7**2+y5**2*y6)*y4+y5*y6**2*y7)*y3*y2
      dF(117) = (y5**2*y7**2+y4**2*y6**2)*y3*y2
      dF(118) = (y5**2*y6**2+y4**2*y7**2)*y3*y2
      dF(119) = y2*y3*y4*y5*y6*y7
      dF(120) = (y4**2+y5**2)*y3*y2**3+(y6**2+y7**2)*y3**3*y2
      dF(121) = (y5*y7+y4*y6)*y3*y2**3+(y5*y7+y4*y6)*y3**3*y2
      dF(122) = (y6**2+y7**2)*y3*y2**3+(y4**2+y5**2)*y3**3*y2
      dF(123) = y2*y3**5+y2**5*y3
      dF(124) = y2**2*y6**2*y7**2+y3**2*y4**2*y5**2
      dF(125) = (y7**4+y6**4)*y2**2+(y4**4+y5**4)*y3**2
      dF(126) = (y5*y6**2*y7+y4*y6*y7**2)*y2**2+(y4**2*y5*y7+y4*y5**2*y6)*y3**2
      dF(127) = (y4*y6**3+y5*y7**3)*y2**2+(y5**3*y7+y4**3*y6)*y3**2
      dF(128) = y2**2*y4*y5*y6*y7+y3**2*y4*y5*y6*y7
      dF(129) = (y5**2*y6**2+y4**2*y7**2)*y2**2+(y5**2*y6**2+y4**2*y7**2)*y3**2
      dF(130) = (y5**2*y7**2+y4**2*y6**2)*y2**2+(y5**2*y7**2+y4**2*y6**2)*y3**2
      dF(131) = (y4**2*y5*y7+y4*y5**2*y6)*y2**2+(y5*y6**2*y7+y4*y6*y7**2)*y3**2
      dF(132) = y2**2*y4**2*y5**2+y3**2*y6**2*y7**2
      dF(133) = (y5**3*y7+y4**3*y6)*y2**2+(y4*y6**3+y5*y7**3)*y3**2
      dF(134) = (y4**4+y5**4)*y2**2+(y7**4+y6**4)*y3**2
      dF(135) = (y5*y7+y4*y6)*y3**2*y2**2
      dF(136) = (y4**2+y7**2+y6**2+y5**2)*y3**2*y2**2
      dF(137) = y2**2*y3**4+y2**4*y3**2
      dF(138) = y2**3*y3**3
      dF(139) = (y2*y6**2*y7**2+y3*y4**2*y5**2)*y1
      dF(140) = ((y7**4+y6**4)*y2+(y4**4+y5**4)*y3)*y1
      dF(141) = ((y5*y6**2*y7+y4*y6*y7**2)*y2+(y4**2*y5*y7+y4*y5**2*y6)*y3)*y1
      dF(142) = ((y4*y6**3+y5*y7**3)*y2+(y5**3*y7+y4**3*y6)*y3)*y1
      dF(143) = (y2*y4*y5*y6*y7+y3*y4*y5*y6*y7)*y1
      dF(144) = ((y5**2*y6**2+y4**2*y7**2)*y2+(y5**2*y6**2+y4**2*y7**2)*y3)*y1
      dF(145) = ((y5**2*y7**2+y4**2*y6**2)*y2+(y5**2*y7**2+y4**2*y6**2)*y3)*y1
      dF(146) = ((y4**2*y5*y7+y4*y5**2*y6)*y2+(y5*y6**2*y7+y4*y6*y7**2)*y3)*y1
      dF(147) = (y2*y4**2*y5**2+y3*y6**2*y7**2)*y1
      dF(148) = ((y5**3*y7+y4**3*y6)*y2+(y4*y6**3+y5*y7**3)*y3)*y1
      dF(149) = ((y4**4+y5**4)*y2+(y7**4+y6**4)*y3)*y1
      dF(150) = ((y6**2+y7**2)*y3*y2**2+(y4**2+y5**2)*y3**2*y2)*y1
      dF(151) = ((y5*y7+y4*y6)*y3*y2**2+(y5*y7+y4*y6)*y3**2*y2)*y1
      dF(152) = ((y4**2+y5**2)*y3*y2**2+(y6**2+y7**2)*y3**2*y2)*y1
      dF(153) = ((y6**2+y7**2)*y2**3+(y4**2+y5**2)*y3**3)*y1
      dF(154) = ((y5*y7+y4*y6)*y2**3+(y5*y7+y4*y6)*y3**3)*y1
      dF(155) = ((y4**2+y5**2)*y2**3+(y6**2+y7**2)*y3**3)*y1
      dF(156) = (y2**3*y3**2+y2**2*y3**3)*y1
      dF(157) = (y2**4*y3+y2*y3**4)*y1
      dF(158) = (y2**5+y3**5)*y1
      dF(159) = y1**2*y4*y5*y6*y7
      dF(160) = (y5**2*y6**2+y4**2*y7**2)*y1**2
      dF(161) = (y5**2*y7**2+y4**2*y6**2)*y1**2
      dF(162) = (y4**2*y5*y7+(y6*y7**2+y5**2*y6)*y4+y5*y6**2*y7)*y1**2
      dF(163) = (y6**2*y7**2+y4**2*y5**2)*y1**2
      dF(164) = (y5*y7**3+y4*y6**3+y4**3*y6+y5**3*y7)*y1**2
      dF(165) = (y7**4+y6**4+y4**4+y5**4)*y1**2
      dF(166) = (y5*y7+y4*y6)*y3*y2*y1**2
      dF(167) = (y4**2+y7**2+y6**2+y5**2)*y3*y2*y1**2
      dF(168) = ((y6**2+y7**2)*y2**2+(y4**2+y5**2)*y3**2)*y1**2
      dF(169) = ((y5*y7+y4*y6)*y2**2+(y5*y7+y4*y6)*y3**2)*y1**2
      dF(170) = ((y4**2+y5**2)*y2**2+(y6**2+y7**2)*y3**2)*y1**2
      dF(171) = y1**2*y2**2*y3**2
      dF(172) = (y2*y3**3+y2**3*y3)*y1**2
      dF(173) = (y2**4+y3**4)*y1**2
      dF(174) = (y3**3+y2**3)*y1**3
      dF(175) = ((y6**2+y7**2)*y2+(y4**2+y5**2)*y3)*y1**3
      dF(176) = ((y5*y7+y4*y6)*y2+(y5*y7+y4*y6)*y3)*y1**3
      dF(177) = ((y4**2+y5**2)*y2+(y6**2+y7**2)*y3)*y1**3
      dF(178) = (y2**2*y3+y2*y3**2)*y1**3
      dF(179) = (y5*y7+y4*y6)*y1**4
      dF(180) = (y4**2+y7**2+y6**2+y5**2)*y1**4
      dF(181) = y1**4*y2*y3
      dF(182) = (y2**2+y3**2)*y1**4
      dF(183) = (y2+y3)*y1**5
      dF(184) = y1**6

      dF(185) = y3**3*y6**2*y7**2+y2**3*y4**2*y5**2
      dF(186) = (y4*y5**2*y6+y4**2*y5*y7)*y2**3+(y4*y6*y7**2+y5*y6**2*y7)*y3**3
      dF(187) = (y5**3*y7+y4**3*y6)*y2**3+(y4*y6**3+y5*y7**3)*y3**3
      dF(188) = y3**3*y4*y5*y6*y7+y2**3*y4*y5*y6*y7
      dF(189) = (y4*y6*y7**2+y5*y6**2*y7)*y2**3+(y4*y5**2*y6+y4**2*y5*y7)*y3**3
      dF(190) = (y5**2*y6**2+y4**2*y7**2)*y2**3+(y5**2*y6**2+y4**2*y7**2)*y3**3
      dF(191) = (y5**2*y7**2+y4**2*y6**2)*y2**3+(y5**2*y7**2+y4**2*y6**2)*y3**3
      dF(192) = y3**3*y4**2*y5**2+y2**3*y6**2*y7**2
      dF(193) = (y4*y6**3+y5*y7**3)*y2**3+(y5**3*y7+y4**3*y6)*y3**3
      dF(194) = (y6**4+y7**4)*y2**3+(y4**4+y5**4)*y3**3
      dF(195) = (y6**2+y7**2)*y2**5+(y5**2+y4**2)*y3**5
      dF(196) = y3**7+y2**7
      dF(197) = (y6**2*y7**4+y6**4*y7**2)*y2+(y4**2*y5**4+y4**4*y5**2)*y3
      dF(198) = (y6**6+y7**6)*y2+(y5**6+y4**6)*y3
      dF(199) = (y4*y6*y7**4+y5*y6**4*y7)*y2+(y4*y5**4*y6+y4**4*y5*y7)*y3
      dF(200) = (y4*y6**3*y7**2+y5*y6**2*y7**3)*y2+(y4**2*y5**3*y7+y4**3*y5**2*y6)*y3
      dF(201) = (y4*y6**5+y5*y7**5)*y2+(y5**5*y7+y4**5*y6)*y3
      dF(202) = (y6*y7**3+y6**3*y7)*y5*y4*y2+(y4*y5**3*y6*y7+y4**3*y5*y6*y7)*y3
      dF(203) = (y5**2*y6**4+y4**2*y7**4)*y2+(y5**4*y6**2+y4**4*y7**2)*y3
      dF(204) = (y4**2*y6**2*y7**2+y5**2*y6**2*y7**2)*y2+(y6**2+y7**2)*y5**2*y4**2*y3
      dF(205) = (y5**2*y7**4+y4**2*y6**4)*y2+(y5**4*y7**2+y4**4*y6**2)*y3
      dF(206) = (y4**2*y5*y7**3+y4*y5**2*y6**3)*y2+(y4**3*y6*y7**2+y5**3*y6**2*y7)*y3
      dF(207) = (y4**2*y5*y6**2*y7+y4*y5**2*y6*y7**2)*y2+(y4**2*y5*y6**2*y7+y4*y5**2*y6*y7**2)*y3
      dF(208) = (y6**2+y7**2)*y5**2*y4**2*y2+(y4**2*y6**2*y7**2+y5**2*y6**2*y7**2)*y3
      dF(209) = (y4**3*y6*y7**2+y5**3*y6**2*y7)*y2+(y4**2*y5*y7**3+y4*y5**2*y6**3)*y3
      dF(210) = (y4**3*y6**3+y5**3*y7**3)*y2+(y4**3*y6**3+y5**3*y7**3)*y3
      dF(211) = (y4*y5**3*y6*y7+y4**3*y5*y6*y7)*y2+(y6*y7**3+y6**3*y7)*y5*y4*y3
      dF(212) = (y4**2*y5**3*y7+y4**3*y5**2*y6)*y2+(y4*y6**3*y7**2+y5*y6**2*y7**3)*y3
      dF(213) = (y5**4*y6**2+y4**4*y7**2)*y2+(y5**2*y6**4+y4**2*y7**4)*y3
      dF(214) = (y5**4*y7**2+y4**4*y6**2)*y2+(y5**2*y7**4+y4**2*y6**4)*y3
      dF(215) = (y4*y5**4*y6+y4**4*y5*y7)*y2+(y4*y6*y7**4+y5*y6**4*y7)*y3
      dF(216) = (y4**2*y5**4+y4**4*y5**2)*y2+(y6**2*y7**4+y6**4*y7**2)*y3
      dF(217) = (y5**5*y7+y4**5*y6)*y2+(y4*y6**5+y5*y7**5)*y3
      dF(218) = (y5**6+y4**6)*y2+(y6**6+y7**6)*y3
      dF(219) = (y5**2+y4**2)*y3*y2**4+(y6**2+y7**2)*y3**4*y2
      dF(220) = (y4*y6+y5*y7)*y3*y2**4+(y4*y6+y5*y7)*y3**4*y2
      dF(221) = (y6**2+y7**2)*y3*y2**4+(y5**2+y4**2)*y3**4*y2
      dF(222) = y2*y3**6+y2**6*y3
      dF(223) = (y6**4+y7**4)*y3*y2**2+(y4**4+y5**4)*y3**2*y2
      dF(224) = y2**2*y3*y6**2*y7**2+y2*y3**2*y4**2*y5**2
      dF(225) = (y4*y6*y7**2+y5*y6**2*y7)*y3*y2**2+(y4*y5**2*y6+y4**2*y5*y7)*y3**2*y2
      dF(226) = (y4*y6**3+y5*y7**3)*y3*y2**2+(y5**3*y7+y4**3*y6)*y3**2*y2
      dF(227) = y2**2*y3*y4*y5*y6*y7+y2*y3**2*y4*y5*y6*y7
      dF(228) = (y4*y5**2*y6+y4**2*y5*y7)*y3*y2**2+(y4*y6*y7**2+y5*y6**2*y7)*y3**2*y2
      dF(229) = (y5**2*y6**2+y4**2*y7**2)*y3*y2**2+(y5**2*y6**2+y4**2*y7**2)*y3**2*y2
      dF(230) = (y5**2*y7**2+y4**2*y6**2)*y3*y2**2+(y5**2*y7**2+y4**2*y6**2)*y3**2*y2
      dF(231) = y2**2*y3*y4**2*y5**2+y2*y3**2*y6**2*y7**2
      dF(232) = (y5**3*y7+y4**3*y6)*y3*y2**2+(y4*y6**3+y5*y7**3)*y3**2*y2
      dF(233) = (y4**4+y5**4)*y3*y2**2+(y6**4+y7**4)*y3**2*y2
      dF(234) = (y5**2+y4**2)*y3**2*y2**3+(y6**2+y7**2)*y3**3*y2**2
      dF(235) = (y4*y6+y5*y7)*y3**2*y2**3+(y4*y6+y5*y7)*y3**3*y2**2
      dF(236) = (y6**2+y7**2)*y3**2*y2**3+(y5**2+y4**2)*y3**3*y2**2
      dF(237) = (y4**4+y5**4)*y2**3+(y6**4+y7**4)*y3**3
      dF(238) = y2**3*y3**4+y2**4*y3**3
      dF(239) = (y5**2+y4**2)*y2**5+(y6**2+y7**2)*y3**5
      dF(240) = (y4*y6+y5*y7)*y2**5+(y4*y6+y5*y7)*y3**5
      dF(241) = y2**5*y3**2+y2**2*y3**5
      dF(242) = (y4**4*y5*y7+(y6*y7**4+y5**4*y6)*y4+y5*y6**4*y7)*y1
      dF(243) = (y4*y6**5+y5**5*y7+y5*y7**5+y4**5*y6)*y1
      dF(244) = (y4**3*y5*y6*y7+(y5**3*y6*y7+(y6*y7**3+y6**3*y7)*y5)*y4)*y1
      dF(245) = (y4**2*y5*y6**2*y7+y4*y5**2*y6*y7**2)*y1
      dF(246) = (((y6**2+y7**2)*y5**2+y6**2*y7**2)*y4**2+y5**2*y6**2*y7**2)*y1
      dF(247) = (y4*y6**3*y7**2+y4**2*y5**3*y7+y5*y6**2*y7**3+y4**3*y5**2*y6)*y1
      dF(248) = (y6**2*y7**4+y6**4*y7**2+y4**2*y5**4+y4**4*y5**2)*y1
      dF(249) = (y4**3*y6*y7**2+y4*y5**2*y6**3+y5**3*y6**2*y7+y4**2*y5*y7**3)*y1
      dF(250) = (y4**3*y6**3+y5**3*y7**3)*y1
      dF(251) = (y5**4*y6**2+y4**2*y7**4+y4**4*y7**2+y5**2*y6**4)*y1
      dF(252) = (y5**4*y7**2+y4**4*y6**2+y5**2*y7**4+y4**2*y6**4)*y1
      dF(253) = (y4**6+y5**6+y6**6+y7**6)*y1
      dF(254) = ((y4*y5**2*y6+y4**2*y5*y7)*y2**2+(y4*y6*y7**2+y5*y6**2*y7)*y3**2)*y1
      dF(255) = (y6**2*y7**2+y4**2*y5**2)*y3*y2*y1
      dF(256) = (y5*y7**3+y4*y6**3+y4**3*y6+y5**3*y7)*y3*y2*y1
      dF(257) = (y4**2*y5*y7+(y5**2*y6+y6*y7**2)*y4+y5*y6**2*y7)*y3*y2*y1
      dF(258) = y1*y2*y3*y4*y5*y6*y7
      dF(259) = (y5**2*y6**2+y4**2*y7**2)*y3*y2*y1
      dF(260) = (y5**2*y7**2+y4**2*y6**2)*y3*y2*y1
      dF(261) = (y4**4+y6**4+y7**4+y5**4)*y3*y2*y1
      dF(262) = (y2**2*y6**2*y7**2+y3**2*y4**2*y5**2)*y1
      dF(263) = ((y6**4+y7**4)*y2**2+(y4**4+y5**4)*y3**2)*y1
      dF(264) = ((y5**2*y6**2+y4**2*y7**2)*y2**2+(y5**2*y6**2+y4**2*y7**2)*y3**2)*y1
      dF(265) = ((y5**3*y7+y4**3*y6)*y2**2+(y4*y6**3+y5*y7**3)*y3**2)*y1
      dF(266) = ((y4**4+y5**4)*y2**2+(y6**4+y7**4)*y3**2)*y1
      dF(267) = ((y4*y6*y7**2+y5*y6**2*y7)*y2**2+(y4*y5**2*y6+y4**2*y5*y7)*y3**2)*y1
      dF(268) = ((y4*y6**3+y5*y7**3)*y2**2+(y5**3*y7+y4**3*y6)*y3**2)*y1
      dF(269) = (y2**2*y4*y5*y6*y7+y3**2*y4*y5*y6*y7)*y1
      dF(270) = ((y5**2*y7**2+y4**2*y6**2)*y2**2+(y5**2*y7**2+y4**2*y6**2)*y3**2)*y1
      dF(271) = (y2**2*y4**2*y5**2+y3**2*y6**2*y7**2)*y1
      dF(272) = (y6**2+y7**2+y5**2+y4**2)*y3**2*y2**2*y1
      dF(273) = (y4*y6+y5*y7)*y3**2*y2**2*y1
      dF(274) = ((y6**2+y7**2)*y3*y2**3+(y5**2+y4**2)*y3**3*y2)*y1
      dF(275) = ((y4*y6+y5*y7)*y3*y2**3+(y4*y6+y5*y7)*y3**3*y2)*y1
      dF(276) = ((y5**2+y4**2)*y3*y2**3+(y6**2+y7**2)*y3**3*y2)*y1
      dF(277) = y1*y2**3*y3**3
      dF(278) = ((y6**2+y7**2)*y2**4+(y5**2+y4**2)*y3**4)*y1
      dF(279) = ((y4*y6+y5*y7)*y2**4+(y4*y6+y5*y7)*y3**4)*y1
      dF(280) = ((y5**2+y4**2)*y2**4+(y6**2+y7**2)*y3**4)*y1
      dF(281) = (y2**2*y3**4+y2**4*y3**2)*y1
      dF(282) = (y2*y3**5+y2**5*y3)*y1
      dF(283) = (y2**6+y3**6)*y1
      dF(284) = (y3*y6**2*y7**2+y2*y4**2*y5**2)*y1**2
      dF(285) = ((y4*y6*y7**2+y5*y6**2*y7)*y2+(y4*y5**2*y6+y4**2*y5*y7)*y3)*y1**2
      dF(286) = ((y6**4+y7**4)*y2+(y4**4+y5**4)*y3)*y1**2
      dF(287) = (y2*y6**2*y7**2+y3*y4**2*y5**2)*y1**2
      dF(288) = ((y4*y6**3+y5*y7**3)*y2+(y5**3*y7+y4**3*y6)*y3)*y1**2
      dF(289) = ((y5**2*y7**2+y4**2*y6**2)*y2+(y5**2*y7**2+y4**2*y6**2)*y3)*y1**2
      dF(290) = (y2*y4*y5*y6*y7+y3*y4*y5*y6*y7)*y1**2
      dF(291) = ((y4*y5**2*y6+y4**2*y5*y7)*y2+(y4*y6*y7**2+y5*y6**2*y7)*y3)*y1**2
      dF(292) = ((y5**2*y6**2+y4**2*y7**2)*y2+(y5**2*y6**2+y4**2*y7**2)*y3)*y1**2
      dF(293) = ((y5**3*y7+y4**3*y6)*y2+(y4*y6**3+y5*y7**3)*y3)*y1**2
      dF(294) = ((y4**4+y5**4)*y2+(y6**4+y7**4)*y3)*y1**2
      dF(295) = ((y6**2+y7**2)*y3*y2**2+(y5**2+y4**2)*y3**2*y2)*y1**2
      dF(296) = ((y4*y6+y5*y7)*y3*y2**2+(y4*y6+y5*y7)*y3**2*y2)*y1**2
      dF(297) = ((y5**2+y4**2)*y3*y2**2+(y6**2+y7**2)*y3**2*y2)*y1**2
      dF(298) = ((y6**2+y7**2)*y2**3+(y5**2+y4**2)*y3**3)*y1**2
      dF(299) = ((y4*y6+y5*y7)*y2**3+(y4*y6+y5*y7)*y3**3)*y1**2
      dF(300) = ((y5**2+y4**2)*y2**3+(y6**2+y7**2)*y3**3)*y1**2
      dF(301) = (y2**2*y3**3+y2**3*y3**2)*y1**2
      dF(302) = (y2*y3**4+y2**4*y3)*y1**2
      dF(303) = (y3**5+y2**5)*y1**2
      dF(304) = (y4**4+y6**4+y7**4+y5**4)*y1**3
      dF(305) = (y6**2*y7**2+y4**2*y5**2)*y1**3
      dF(306) = (y5**2*y6**2+y4**2*y7**2)*y1**3
      dF(307) = (y4**2*y5*y7+(y5**2*y6+y6*y7**2)*y4+y5*y6**2*y7)*y1**3
      dF(308) = y1**3*y4*y5*y6*y7
      dF(309) = (y5**2*y7**2+y4**2*y6**2)*y1**3
      dF(310) = (y5*y7**3+y4*y6**3+y4**3*y6+y5**3*y7)*y1**3
      dF(311) = ((y4*y6+y5*y7)*y2**2+(y4*y6+y5*y7)*y3**2)*y1**3
      dF(312) = (y6**2+y7**2+y5**2+y4**2)*y3*y2*y1**3
      dF(313) = (y4*y6+y5*y7)*y3*y2*y1**3
      dF(314) = (y2**3*y3+y2*y3**3)*y1**3
      dF(315) = ((y6**2+y7**2)*y2**2+(y5**2+y4**2)*y3**2)*y1**3
      dF(316) = ((y5**2+y4**2)*y2**2+(y6**2+y7**2)*y3**2)*y1**3
      dF(317) = y1**3*y2**2*y3**2
      dF(318) = (y2**4+y3**4)*y1**3
      dF(319) = ((y4*y6+y5*y7)*y2+(y4*y6+y5*y7)*y3)*y1**4
      dF(320) = ((y6**2+y7**2)*y2+(y5**2+y4**2)*y3)*y1**4
      dF(321) = ((y5**2+y4**2)*y2+(y6**2+y7**2)*y3)*y1**4
      dF(322) = (y2**2*y3+y2*y3**2)*y1**4
      dF(323) = (y2**3+y3**3)*y1**4
      dF(324) = (y6**2+y7**2+y5**2+y4**2)*y1**5
      dF(325) = (y4*y6+y5*y7)*y1**5
      dF(326) = (y2**2+y3**2)*y1**5
      dF(327) = y1**5*y2*y3
      dF(328) = (y2+y3)*y1**6
      dF(329) = y1**7

      dF(330) = y4**8+y7**8+y5**8+y6**8
      dF(331) = y6**4*y7**4+y4**4*y5**4
      dF(332) = (y6**3*y7**2+y5**2*y6**3)*y4**3+y4**2*y5**3*y7**3+y5**3*y6**2*y7**3
      dF(333) = y4*y5**2*y6**5+y4**2*y5*y7**5+y4**5*y6*y7**2+y5**5*y6**2*y7
      dF(334) = y4**6*y5*y7+(y5**6*y6+y6*y7**6)*y4+y5*y6**6*y7
      dF(335) = y4*y5*y6**3*y7**3+y4**3*y5**3*y6*y7
      dF(336) = y4**3*y5**2*y6*y7**2+(y5*y6**2*y7**3+y5**3*y6**2*y7)*y4**2+y4*y5**2*y6**3*y7**2
      dF(337) = y4*y5**3*y6*y7**3+y4**3*y5*y6**3*y7
      dF(338) = y4*y5**3*y6**3*y7+y4**3*y5*y6*y7**3
      dF(339) = y4**4*y5*y6**2*y7+y4**2*y5*y6**4*y7+(y5**2*y6*y7**4+y5**4*y6*y7**2)*y4
      dF(340) = y4**2*y5**2*y6**2*y7**2
      dF(341) = y4**4*y7**4+y5**4*y6**4
      dF(342) = y4**4*y6**2*y7**2+(y6**4+y7**4)*y5**2*y4**2+y5**4*y6**2*y7**2
      dF(343) = y4**4*y6**4+y5**4*y7**4
      dF(344) = y4**3*y6*y7**4+y4**4*y5*y7**3+y4*y5**4*y6**3+y5**3*y6**4*y7
      dF(345) = y4**4*y5**2*y7**2+(y6**2*y7**4+y5**4*y6**2)*y4**2+y5**2*y6**4*y7**2
      dF(346) = y4**4*y5**2*y6**2+(y6**4*y7**2+y5**4*y7**2)*y4**2+y5**2*y6**2*y7**4
      dF(347) = y5*y6**4*y7**3+y4**3*y5**4*y6+y4*y6**3*y7**4+y4**4*y5**3*y7
      dF(348) = y4**5*y6**3+y5**3*y7**5+y5**5*y7**3+y4**3*y6**5
      dF(349) = y4**5*y5*y6*y7+(y5**5*y6*y7+(y6*y7**5+y6**5*y7)*y5)*y4
      dF(350) = y4*y6**5*y7**2+y4**5*y5**2*y6+y4**2*y5**5*y7+y5*y6**2*y7**5
      dF(351) = y5**6*y6**2+y4**6*y7**2+y4**2*y7**6+y5**2*y6**6
      dF(352) = y4**6*y6**2+y4**2*y6**6+y5**6*y7**2+y5**2*y7**6
      dF(353) = y4**6*y5**2+y6**6*y7**2+y6**2*y7**6+y4**2*y5**6
      dF(354) = y4**7*y6+y4*y6**7+y5**7*y7+y5*y7**7
      dF(355) = (y4**3*y5**2*y6+y4**2*y5**3*y7)*y2**2+(y5*y6**2*y7**3+y4*y6**3*y7**2)*y3**2
      dF(356) = y3**4*y6**2*y7**2+y2**4*y4**2*y5**2
      dF(357) = (y7**6+y6**6+y5**6+y4**6)*y3*y2
      dF(358) = (y4**4*y5**2+y4**2*y5**4+y6**4*y7**2+y6**2*y7**4)*y3*y2
      dF(359) = (y5**5*y7+y4*y6**5+y4**5*y6+y5*y7**5)*y3*y2
      dF(360) = (y4*y6**3*y7**2+y4**2*y5**3*y7+y4**3*y5**2*y6+y5*y6**2*y7**3)*y3*y2
      dF(361) = (y4**4*y5*y7+(y6*y7**4+y5**4*y6)*y4+y5*y6**4*y7)*y3*y2
      dF(362) = (y5**4*y7**2+y4**2*y6**4+y4**4*y6**2+y5**2*y7**4)*y3*y2
      dF(363) = (((y7**2+y6**2)*y5**2+y6**2*y7**2)*y4**2+y5**2*y6**2*y7**2)*y3*y2
      dF(364) = (y5**4*y6**2+y4**4*y7**2+y4**2*y7**4+y5**2*y6**4)*y3*y2
      dF(365) = (y4**3*y6**3+y5**3*y7**3)*y3*y2
      dF(366) = (y4*y5**2*y6**3+y5**3*y6**2*y7+y4**2*y5*y7**3+y4**3*y6*y7**2)*y3*y2
      dF(367) = (y4**3*y5*y6*y7+(y5**3*y6*y7+(y6*y7**3+y6**3*y7)*y5)*y4)*y3*y2
      dF(368) = (y4*y5**2*y6*y7**2+y4**2*y5*y6**2*y7)*y3*y2
      dF(369) = y2*y3**3*y6**2*y7**2+y2**3*y3*y4**2*y5**2
      dF(370) = (y5**2*y7**2+y4**2*y6**2)*y3*y2**3+(y5**2*y7**2+y4**2*y6**2)*y3**3*y2
      dF(371) = (y5**2+y4**2)*y3*y2**5+(y7**2+y6**2)*y3**5*y2
      dF(372) = (y5*y7+y4*y6)*y3*y2**5+(y5*y7+y4*y6)*y3**5*y2
      dF(373) = (y7**2+y6**2)*y3*y2**5+(y5**2+y4**2)*y3**5*y2
      dF(374) = y2*y3**7+y2**7*y3
      dF(375) = (y7**6+y6**6)*y2**2+(y4**6+y5**6)*y3**2
      dF(376) = (y6**4*y7**2+y6**2*y7**4)*y2**2+(y4**2*y5**4+y4**4*y5**2)*y3**2
      dF(377) = (y5*y7**5+y4*y6**5)*y2**2+(y4**5*y6+y5**5*y7)*y3**2
      dF(378) = (y5*y6**2*y7**3+y4*y6**3*y7**2)*y2**2+(y4**3*y5**2*y6+y4**2*y5**3*y7)*y3**2
      dF(379) = (y5**2*y7**4+y4**2*y6**4)*y2**2+(y4**4*y6**2+y5**4*y7**2)*y3**2
      dF(380) = (y5**2*y6**2*y7**2+y4**2*y6**2*y7**2)*y2**2+(y7**2+y6**2)*y5**2*y4**2*y3**2
      dF(381) = (y5**2*y6**4+y4**2*y7**4)*y2**2+(y4**4*y7**2+y5**4*y6**2)*y3**2
      dF(382) = (y5**3*y6**2*y7+y4**3*y6*y7**2)*y2**2+(y4**2*y5*y7**3+y4*y5**2*y6**3)*y3**2
      dF(383) = (y4**5*y6+y5**5*y7)*y2**2+(y5*y7**5+y4*y6**5)*y3**2
      dF(384) = (y4*y6*y7**4+y5*y6**4*y7)*y2**2+(y4*y5**4*y6+y4**4*y5*y7)*y3**2
      dF(385) = (y6*y7**3+y6**3*y7)*y5*y4*y2**2+(y4**3*y5*y6*y7+y4*y5**3*y6*y7)*y3**2
      dF(386) = (y4**2*y5*y7**3+y4*y5**2*y6**3)*y2**2+(y5**3*y6**2*y7+y4**3*y6*y7**2)*y3**2
      dF(387) = (y4*y5**2*y6*y7**2+y4**2*y5*y6**2*y7)*y2**2+(y4*y5**2*y6*y7**2+y4**2*y5*y6**2*y7)*y3**2
      dF(388) = (y7**2+y6**2)*y5**2*y4**2*y2**2+(y5**2*y6**2*y7**2+y4**2*y6**2*y7**2)*y3**2
      dF(389) = (y4**2*y5**4+y4**4*y5**2)*y2**2+(y6**4*y7**2+y6**2*y7**4)*y3**2
      dF(390) = (y4**3*y6**3+y5**3*y7**3)*y2**2+(y4**3*y6**3+y5**3*y7**3)*y3**2
      dF(391) = (y4**3*y5*y6*y7+y4*y5**3*y6*y7)*y2**2+(y6*y7**3+y6**3*y7)*y5*y4*y3**2
      dF(392) = (y4**4*y7**2+y5**4*y6**2)*y2**2+(y5**2*y6**4+y4**2*y7**4)*y3**2
      dF(393) = (y4**4*y6**2+y5**4*y7**2)*y2**2+(y5**2*y7**4+y4**2*y6**4)*y3**2
      dF(394) = (y4*y5**4*y6+y4**4*y5*y7)*y2**2+(y4*y6*y7**4+y5*y6**4*y7)*y3**2
      dF(395) = (y4**6+y5**6)*y2**2+(y7**6+y6**6)*y3**2
      dF(396) = (y6**4+y4**4+y7**4+y5**4)*y3**2*y2**2
      dF(397) = (y4**2*y5*y7+(y6*y7**2+y5**2*y6)*y4+y5*y6**2*y7)*y3**2*y2**2
      dF(398) = (y5**2*y7**2+y4**2*y6**2)*y3**2*y2**2
      dF(399) = (y4*y6**3+y5*y7**3+y5**3*y7+y4**3*y6)*y3**2*y2**2
      dF(400) = y2**2*y3**2*y4*y5*y6*y7
      dF(401) = (y4**2*y7**2+y5**2*y6**2)*y3**2*y2**2
      dF(402) = (y4**2*y5**2+y6**2*y7**2)*y3**2*y2**2
      dF(403) = (y5**2+y4**2)*y3**2*y2**4+(y7**2+y6**2)*y3**4*y2**2
      dF(404) = (y5*y7+y4*y6)*y3**2*y2**4+(y5*y7+y4*y6)*y3**4*y2**2
      dF(405) = (y7**2+y6**2)*y3**2*y2**4+(y5**2+y4**2)*y3**4*y2**2
      dF(406) = y2**2*y3**6+y2**6*y3**2
      dF(407) = (y6**4+y7**4)*y3*y2**3+(y4**4+y5**4)*y3**3*y2
      dF(408) = y2*y3**3*y4**2*y5**2+y2**3*y3*y6**2*y7**2
      dF(409) = (y4*y6*y7**2+y5*y6**2*y7)*y3*y2**3+(y4**2*y5*y7+y4*y5**2*y6)*y3**3*y2
      dF(410) = (y4**2*y7**2+y5**2*y6**2)*y3*y2**3+(y4**2*y7**2+y5**2*y6**2)*y3**3*y2
      dF(411) = (y4**3*y6+y5**3*y7)*y3*y2**3+(y4*y6**3+y5*y7**3)*y3**3*y2
      dF(412) = (y4*y6**3+y5*y7**3)*y3*y2**3+(y4**3*y6+y5**3*y7)*y3**3*y2
      dF(413) = y2*y3**3*y4*y5*y6*y7+y2**3*y3*y4*y5*y6*y7
      dF(414) = (y4**2*y5*y7+y4*y5**2*y6)*y3*y2**3+(y4*y6*y7**2+y5*y6**2*y7)*y3**3*y2
      dF(415) = (y4**4+y5**4)*y3*y2**3+(y6**4+y7**4)*y3**3*y2
      dF(416) = (y5**2+y4**2+y7**2+y6**2)*y3**3*y2**3
      dF(417) = (y5*y7+y4*y6)*y3**3*y2**3
      dF(418) = y3**4*y4**2*y5**2+y2**4*y6**2*y7**2
      dF(419) = (y6**4+y7**4)*y2**4+(y4**4+y5**4)*y3**4
      dF(420) = (y5**2*y7**2+y4**2*y6**2)*y2**4+(y5**2*y7**2+y4**2*y6**2)*y3**4
      dF(421) = (y4*y6*y7**2+y5*y6**2*y7)*y2**4+(y4**2*y5*y7+y4*y5**2*y6)*y3**4
      dF(422) = (y4*y6**3+y5*y7**3)*y2**4+(y4**3*y6+y5**3*y7)*y3**4
      dF(423) = y2**4*y4*y5*y6*y7+y3**4*y4*y5*y6*y7
      dF(424) = (y4**2*y5*y7+y4*y5**2*y6)*y2**4+(y4*y6*y7**2+y5*y6**2*y7)*y3**4
      dF(425) = (y4**2*y7**2+y5**2*y6**2)*y2**4+(y4**2*y7**2+y5**2*y6**2)*y3**4
      dF(426) = (y4**3*y6+y5**3*y7)*y2**4+(y4*y6**3+y5*y7**3)*y3**4
      dF(427) = (y4**4+y5**4)*y2**4+(y6**4+y7**4)*y3**4
      dF(428) = y2**4*y3**4
      dF(429) = y2**5*y3**3+y2**3*y3**5
      dF(430) = (y7**2+y6**2)*y2**6+(y5**2+y4**2)*y3**6
      dF(431) = (y5*y7+y4*y6)*y2**6+(y5*y7+y4*y6)*y3**6
      dF(432) = (y5**2+y4**2)*y2**6+(y7**2+y6**2)*y3**6
      dF(433) = y2**8+y3**8
      dF(434) = ((y7**2+y6**2)*y5**2*y4**2*y2+(y5**2*y6**2*y7**2+y4**2*y6**2*y7**2)*y3)*y1
      dF(435) = ((y4**4*y6**2+y5**4*y7**2)*y2+(y5**2*y7**4+y4**2*y6**4)*y3)*y1
      dF(436) = ((y5**3*y6**2*y7+y4**3*y6*y7**2)*y2+(y4**2*y5*y7**3+y4*y5**2*y6**3)*y3)*y1
      dF(437) = ((y4*y5**2*y6*y7**2+y4**2*y5*y6**2*y7)*y2+(y4*y5**2*y6*y7**2+y4**2*y5*y6**2*y7)*y3)*y1
      dF(438) = ((y5*y6**2*y7**3+y4*y6**3*y7**2)*y2+(y4**3*y5**2*y6+y4**2*y5**3*y7)*y3)*y1
      dF(439) = ((y5**2*y7**4+y4**2*y6**4)*y2+(y4**4*y6**2+y5**4*y7**2)*y3)*y1
      dF(440) = ((y6**4*y7**2+y6**2*y7**4)*y2+(y4**2*y5**4+y4**4*y5**2)*y3)*y1
      dF(441) = ((y7**6+y6**6)*y2+(y4**6+y5**6)*y3)*y1
      dF(442) = ((y6**4+y7**4)*y2**3+(y4**4+y5**4)*y3**3)*y1
      dF(443) = ((y5*y7**5+y4*y6**5)*y2+(y4**5*y6+y5**5*y7)*y3)*y1
      dF(444) = ((y4*y6*y7**4+y5*y6**4*y7)*y2+(y4*y5**4*y6+y4**4*y5*y7)*y3)*y1
      dF(445) = ((y5**2*y6**2*y7**2+y4**2*y6**2*y7**2)*y2+(y7**2+y6**2)*y5**2*y4**2*y3)*y1
      dF(446) = ((y4**3*y6**3+y5**3*y7**3)*y2+(y4**3*y6**3+y5**3*y7**3)*y3)*y1
      dF(447) = ((y6*y7**3+y6**3*y7)*y5*y4*y2+(y4**3*y5*y6*y7+y4*y5**3*y6*y7)*y3)*y1
      dF(448) = ((y5**2*y6**4+y4**2*y7**4)*y2+(y4**4*y7**2+y5**4*y6**2)*y3)*y1
      dF(449) = ((y4**2*y5*y7**3+y4*y5**2*y6**3)*y2+(y5**3*y6**2*y7+y4**3*y6*y7**2)*y3)*y1
      dF(450) = ((y4**3*y5*y6*y7+y4*y5**3*y6*y7)*y2+(y6*y7**3+y6**3*y7)*y5*y4*y3)*y1
      dF(451) = ((y4**3*y5**2*y6+y4**2*y5**3*y7)*y2+(y5*y6**2*y7**3+y4*y6**3*y7**2)*y3)*y1
      dF(452) = ((y4**4*y7**2+y5**4*y6**2)*y2+(y5**2*y6**4+y4**2*y7**4)*y3)*y1
      dF(453) = ((y4*y5**4*y6+y4**4*y5*y7)*y2+(y4*y6*y7**4+y5*y6**4*y7)*y3)*y1
      dF(454) = ((y4**2*y5**4+y4**4*y5**2)*y2+(y6**4*y7**2+y6**2*y7**4)*y3)*y1
      dF(455) = ((y4**5*y6+y5**5*y7)*y2+(y5*y7**5+y4*y6**5)*y3)*y1
      dF(456) = ((y4**6+y5**6)*y2+(y7**6+y6**6)*y3)*y1
      dF(457) = ((y5**2+y4**2)*y3*y2**4+(y7**2+y6**2)*y3**4*y2)*y1
      dF(458) = ((y5*y7+y4*y6)*y3*y2**4+(y5*y7+y4*y6)*y3**4*y2)*y1
      dF(459) = ((y7**2+y6**2)*y3*y2**4+(y5**2+y4**2)*y3**4*y2)*y1
      dF(460) = (y2*y3**6+y2**6*y3)*y1
      dF(461) = ((y6**4+y7**4)*y3*y2**2+(y4**4+y5**4)*y3**2*y2)*y1
      dF(462) = (y2**2*y3*y6**2*y7**2+y2*y3**2*y4**2*y5**2)*y1
      dF(463) = ((y4*y6**3+y5*y7**3)*y3*y2**2+(y4**3*y6+y5**3*y7)*y3**2*y2)*y1
      dF(464) = ((y5**2*y7**2+y4**2*y6**2)*y3*y2**2+(y5**2*y7**2+y4**2*y6**2)*y3**2*y2)*y1
      dF(465) = ((y4**2*y7**2+y5**2*y6**2)*y3*y2**2+(y4**2*y7**2+y5**2*y6**2)*y3**2*y2)*y1
      dF(466) = ((y4**3*y6+y5**3*y7)*y3*y2**2+(y4*y6**3+y5*y7**3)*y3**2*y2)*y1
      dF(467) = ((y4**4+y5**4)*y3*y2**2+(y6**4+y7**4)*y3**2*y2)*y1
      dF(468) = ((y4*y6*y7**2+y5*y6**2*y7)*y3*y2**2+(y4**2*y5*y7+y4*y5**2*y6)*y3**2*y2)*y1
      dF(469) = (y2**2*y3*y4*y5*y6*y7+y2*y3**2*y4*y5*y6*y7)*y1
      dF(470) = ((y4**2*y5*y7+y4*y5**2*y6)*y3*y2**2+(y4*y6*y7**2+y5*y6**2*y7)*y3**2*y2)*y1
      dF(471) = (y2**2*y3*y4**2*y5**2+y2*y3**2*y6**2*y7**2)*y1
      dF(472) = (y2**3*y6**2*y7**2+y3**3*y4**2*y5**2)*y1
      dF(473) = ((y4*y6*y7**2+y5*y6**2*y7)*y2**3+(y4**2*y5*y7+y4*y5**2*y6)*y3**3)*y1
      dF(474) = ((y4*y6**3+y5*y7**3)*y2**3+(y4**3*y6+y5**3*y7)*y3**3)*y1
      dF(475) = (y2**3*y4*y5*y6*y7+y3**3*y4*y5*y6*y7)*y1
      dF(476) = ((y4**2*y7**2+y5**2*y6**2)*y2**3+(y4**2*y7**2+y5**2*y6**2)*y3**3)*y1
      dF(477) = ((y5**2*y7**2+y4**2*y6**2)*y2**3+(y5**2*y7**2+y4**2*y6**2)*y3**3)*y1
      dF(478) = ((y4**2*y5*y7+y4*y5**2*y6)*y2**3+(y4*y6*y7**2+y5*y6**2*y7)*y3**3)*y1
      dF(479) = (y2**3*y4**2*y5**2+y3**3*y6**2*y7**2)*y1
      dF(480) = ((y4**3*y6+y5**3*y7)*y2**3+(y4*y6**3+y5*y7**3)*y3**3)*y1
      dF(481) = ((y4**4+y5**4)*y2**3+(y6**4+y7**4)*y3**3)*y1
      dF(482) = ((y7**2+y6**2)*y3**2*y2**3+(y5**2+y4**2)*y3**3*y2**2)*y1
      dF(483) = ((y5*y7+y4*y6)*y3**2*y2**3+(y5*y7+y4*y6)*y3**3*y2**2)*y1
      dF(484) = ((y5**2+y4**2)*y3**2*y2**3+(y7**2+y6**2)*y3**3*y2**2)*y1
      dF(485) = (y2**4*y3**3+y2**3*y3**4)*y1
      dF(486) = ((y7**2+y6**2)*y2**5+(y5**2+y4**2)*y3**5)*y1
      dF(487) = ((y5*y7+y4*y6)*y2**5+(y5*y7+y4*y6)*y3**5)*y1
      dF(488) = ((y5**2+y4**2)*y2**5+(y7**2+y6**2)*y3**5)*y1
      dF(489) = (y2**5*y3**2+y2**2*y3**5)*y1
      dF(490) = (y2**7+y3**7)*y1
      dF(491) = (y4*y5**2*y6*y7**2+y4**2*y5*y6**2*y7)*y1**2
      dF(492) = (((y7**2+y6**2)*y5**2+y6**2*y7**2)*y4**2+y5**2*y6**2*y7**2)*y1**2
      dF(493) = (y4*y5**2*y6**3+y5**3*y6**2*y7+y4**2*y5*y7**3+y4**3*y6*y7**2)*y1**2
      dF(494) = (y4**3*y6**3+y5**3*y7**3)*y1**2
      dF(495) = (y4**3*y5*y6*y7+(y5**3*y6*y7+(y6*y7**3+y6**3*y7)*y5)*y4)*y1**2
      dF(496) = (y4*y6**3*y7**2+y4**2*y5**3*y7+y4**3*y5**2*y6+y5*y6**2*y7**3)*y1**2
      dF(497) = (y5**4*y6**2+y4**4*y7**2+y4**2*y7**4+y5**2*y6**4)*y1**2
      dF(498) = (y5**4*y7**2+y4**2*y6**4+y4**4*y6**2+y5**2*y7**4)*y1**2
      dF(499) = (y4**4*y5*y7+(y6*y7**4+y5**4*y6)*y4+y5*y6**4*y7)*y1**2
      dF(500) = (y4**4*y5**2+y4**2*y5**4+y6**4*y7**2+y6**2*y7**4)*y1**2
      dF(501) = (y5**5*y7+y4*y6**5+y4**5*y6+y5*y7**5)*y1**2
      dF(502) = (y7**6+y6**6+y5**6+y4**6)*y1**2
      dF(503) = (y3**2*y6**2*y7**2+y2**2*y4**2*y5**2)*y1**2
      dF(504) = ((y4**2*y7**2+y5**2*y6**2)*y2**2+(y4**2*y7**2+y5**2*y6**2)*y3**2)*y1**2
      dF(505) = ((y4*y6**3+y5*y7**3)*y2**2+(y4**3*y6+y5**3*y7)*y3**2)*y1**2
      dF(506) = ((y6**4+y7**4)*y2**2+(y4**4+y5**4)*y3**2)*y1**2
      dF(507) = ((y5**2+y4**2)*y2**4+(y7**2+y6**2)*y3**4)*y1**2
      dF(508) = ((y5*y7+y4*y6)*y2**4+(y5*y7+y4*y6)*y3**4)*y1**2
      dF(509) = ((y7**2+y6**2)*y2**4+(y5**2+y4**2)*y3**4)*y1**2
      dF(510) = (y3**6+y2**6)*y1**2
      dF(511) = (y4**2*y5**2+y6**2*y7**2)*y3*y2*y1**2
      dF(512) = (y6**4+y4**4+y7**4+y5**4)*y3*y2*y1**2
      dF(513) = (y4**2*y5*y7+(y6*y7**2+y5**2*y6)*y4+y5*y6**2*y7)*y3*y2*y1**2
      dF(514) = (y5**2*y7**2+y4**2*y6**2)*y3*y2*y1**2
      dF(515) = (y4**2*y7**2+y5**2*y6**2)*y3*y2*y1**2
      dF(516) = (y4*y6**3+y5*y7**3+y5**3*y7+y4**3*y6)*y3*y2*y1**2
      dF(517) = y1**2*y2*y3*y4*y5*y6*y7
      dF(518) = ((y5**2+y4**2)*y3*y2**3+(y7**2+y6**2)*y3**3*y2)*y1**2
      dF(519) = ((y5*y7+y4*y6)*y3*y2**3+(y5*y7+y4*y6)*y3**3*y2)*y1**2
      dF(520) = ((y7**2+y6**2)*y3*y2**3+(y5**2+y4**2)*y3**3*y2)*y1**2
      dF(521) = (y2**5*y3+y2*y3**5)*y1**2
      dF(522) = (y3**2*y4**2*y5**2+y2**2*y6**2*y7**2)*y1**2
      dF(523) = ((y4*y6*y7**2+y5*y6**2*y7)*y2**2+(y4**2*y5*y7+y4*y5**2*y6)*y3**2)*y1**2
      dF(524) = (y3**2*y4*y5*y6*y7+y2**2*y4*y5*y6*y7)*y1**2
      dF(525) = ((y5**2*y7**2+y4**2*y6**2)*y2**2+(y5**2*y7**2+y4**2*y6**2)*y3**2)*y1**2
      dF(526) = ((y4**2*y5*y7+y4*y5**2*y6)*y2**2+(y4*y6*y7**2+y5*y6**2*y7)*y3**2)*y1**2
      dF(527) = ((y4**3*y6+y5**3*y7)*y2**2+(y4*y6**3+y5*y7**3)*y3**2)*y1**2
      dF(528) = ((y4**4+y5**4)*y2**2+(y6**4+y7**4)*y3**2)*y1**2
      dF(529) = (y5*y7+y4*y6)*y3**2*y2**2*y1**2
      dF(530) = (y5**2+y4**2+y7**2+y6**2)*y3**2*y2**2*y1**2
      dF(531) = y1**2*y2**3*y3**3
      dF(532) = (y2**2*y3**4+y2**4*y3**2)*y1**2
      dF(533) = ((y4**4+y5**4)*y2+(y6**4+y7**4)*y3)*y1**3
      dF(534) = (y2*y4**2*y5**2+y3*y6**2*y7**2)*y1**3
      dF(535) = ((y4**2*y5*y7+y4*y5**2*y6)*y2+(y4*y6*y7**2+y5*y6**2*y7)*y3)*y1**3
      dF(536) = ((y5**2*y7**2+y4**2*y6**2)*y2+(y5**2*y7**2+y4**2*y6**2)*y3)*y1**3
      dF(537) = ((y6**4+y7**4)*y2+(y4**4+y5**4)*y3)*y1**3
      dF(538) = ((y4**2*y7**2+y5**2*y6**2)*y2+(y4**2*y7**2+y5**2*y6**2)*y3)*y1**3
      dF(539) = (y2**5+y3**5)*y1**3
      dF(540) = (y3*y4**2*y5**2+y2*y6**2*y7**2)*y1**3
      dF(541) = ((y4*y6*y7**2+y5*y6**2*y7)*y2+(y4**2*y5*y7+y4*y5**2*y6)*y3)*y1**3
      dF(542) = ((y4*y6**3+y5*y7**3)*y2+(y4**3*y6+y5**3*y7)*y3)*y1**3
      dF(543) = (y3*y4*y5*y6*y7+y2*y4*y5*y6*y7)*y1**3
      dF(544) = ((y4**3*y6+y5**3*y7)*y2+(y4*y6**3+y5*y7**3)*y3)*y1**3
      dF(545) = (y2**4*y3+y2*y3**4)*y1**3
      dF(546) = ((y7**2+y6**2)*y3*y2**2+(y5**2+y4**2)*y3**2*y2)*y1**3
      dF(547) = ((y5*y7+y4*y6)*y3*y2**2+(y5*y7+y4*y6)*y3**2*y2)*y1**3
      dF(548) = ((y5**2+y4**2)*y3*y2**2+(y7**2+y6**2)*y3**2*y2)*y1**3
      dF(549) = (y2**3*y3**2+y2**2*y3**3)*y1**3
      dF(550) = ((y7**2+y6**2)*y2**3+(y5**2+y4**2)*y3**3)*y1**3
      dF(551) = ((y5*y7+y4*y6)*y2**3+(y5*y7+y4*y6)*y3**3)*y1**3
      dF(552) = ((y5**2+y4**2)*y2**3+(y7**2+y6**2)*y3**3)*y1**3
      dF(553) = (y4*y6**3+y5*y7**3+y5**3*y7+y4**3*y6)*y1**4
      dF(554) = y1**4*y4*y5*y6*y7
      dF(555) = (y4**2*y7**2+y5**2*y6**2)*y1**4
      dF(556) = (y5**2*y7**2+y4**2*y6**2)*y1**4
      dF(557) = (y4**2*y5*y7+(y6*y7**2+y5**2*y6)*y4+y5*y6**2*y7)*y1**4
      dF(558) = (y4**2*y5**2+y6**2*y7**2)*y1**4
      dF(559) = (y6**4+y4**4+y7**4+y5**4)*y1**4
      dF(560) = ((y5**2+y4**2)*y2**2+(y7**2+y6**2)*y3**2)*y1**4
      dF(561) = ((y5*y7+y4*y6)*y2**2+(y5*y7+y4*y6)*y3**2)*y1**4
      dF(562) = ((y7**2+y6**2)*y2**2+(y5**2+y4**2)*y3**2)*y1**4
      dF(563) = (y2**4+y3**4)*y1**4
      dF(564) = (y5**2+y4**2+y7**2+y6**2)*y3*y2*y1**4
      dF(565) = (y5*y7+y4*y6)*y3*y2*y1**4
      dF(566) = (y2**3*y3+y2*y3**3)*y1**4
      dF(567) = y1**4*y2**2*y3**2
      dF(568) = (y2**3+y3**3)*y1**5
      dF(569) = ((y7**2+y6**2)*y2+(y5**2+y4**2)*y3)*y1**5
      dF(570) = ((y5*y7+y4*y6)*y2+(y5*y7+y4*y6)*y3)*y1**5
      dF(571) = ((y5**2+y4**2)*y2+(y7**2+y6**2)*y3)*y1**5
      dF(572) = (y2*y3**2+y2**2*y3)*y1**5
      dF(573) = (y5*y7+y4*y6)*y1**6
      dF(574) = (y5**2+y4**2+y7**2+y6**2)*y1**6
      dF(575) = y1**6*y2*y3
      dF(576) = (y2**2+y3**2)*y1**6
      dF(577) = (y2+y3)*y1**7
      dF(578) = y1**8

    f = sum(func%params(5:func%nparams(irank),irank)*dF(5:func%nparams(irank)))

end subroutine poten_c2h2_7coords_ADF


!###############################################################################


subroutine poten_c2h2_strey_mills_ADF(molec, func, internal, f, cart)
  use adf
  implicit none

  type(HM_molec_type), intent(in) :: molec
  type(HM_func_type), intent(in)  :: func
  type(adf_realq), intent(in)     :: internal(molec%nmodes)
  type(adf_realq), intent(out)    :: f(func%rank)
  type(adf_realq), intent(in), optional :: cart(molec%natoms,3)

  integer(ik) :: irank
  real(ark) :: e1, e2
  type(adf_realq) :: r0, r1, r2, r3, y1, y2, y3, y4, y5, y6, sintau, alpha1, alpha2, tau, dF(44)

  irank = 1

  ! internal coordinates

  if (trim(molec%coord_transform)=='C2H2_RDALPHATAU') then

    r0     = internal(1)
    r1     = internal(2)
    r2     = internal(3)
    alpha1 = internal(4)+real(pi,ark)
    alpha2 = internal(5)+real(pi,ark)
    tau    = internal(6)

  else

    write(out, '(/a,a,a)') 'poten_c2h2_strey_mills_ADF error: coordinate type = "', trim(molec%coord_transform), '" is not supported'
    stop

  endif

  ! expansion functions

  e1 = func%params(1,irank)
  e2 = func%params(2,irank)

  y1 = r0-e1
  y2 = r1-e2
  y3 = r2-e2
  y4 = alpha1-real(pi,ark)
  y5 = alpha2-real(pi,ark)
  y6 = cos(tau)
  sintau = sin(tau)

  ! potential

      dF(1:4) = 0.0_ark
      !
      dF(5) = 0.5_ark*((y2*y2)+(y3*y3))
      dF(6) = 0.5_ark*(y1*y1)
      dF(7) = y2*y3
      dF(8) = (y2+y3)*y1
      dF(9) = (1.0_ark/6.0_ark)*((y2*y2*y2)+(y3*y3*y3))
      dF(10) = 0.5_ark*((y2*y2*y3)+(y3*y3*y2))
      dF(11) = 0.5_ark*(((y2*y2)+(y3*y3))*y1)
      dF(12) = y2*y3*y1
      dF(13) = 0.5_ark*((y2+y3)*y1*y1)
      dF(14) = (1.0_ark/6.0_ark)*(y1*y1*y1)
      dF(15) = (1.0_ark/24.0_ark)*((y2*y2*y2*y2)+(y3*y3*y3*y3))
      dF(16) = (1.0_ark/6.0_ark)*((y2*y2*y2*y3)+(y2*y3*y3*y3))
      dF(17) = (1.0_ark/4.0_ark)*(y2*y2*y3*y3)
      dF(18) = (1.0_ark/6.0_ark)*((y2*y2*y2)+(y3*y3*y3))*y1
      dF(19) = 0.5_ark*((y2*y2*y3)+(y3*y3*y2))*y1
      dF(20) = 0.25_ark*(((y2*y2)+(y3*y3))*y1*y1)
      dF(21) = 0.5_ark*y2*y3*y1*y1
      dF(22) = (1.0_ark/6.0_ark)*((y2+y3)*y1*y1*y1)
      dF(23) = (1.0_ark/24.0_ark)*(y1*y1*y1*y1)
      dF(24) = 0.25_ark*((y2*y2*y4*y4)+(y3*y3*y5*y5))
      dF(25) = 0.25_ark*((y2*y2*y5*y5)+(y3*y3*y4*y4))
      dF(26) = 0.5_ark*((y2*y2)+(y3*y3))*y4*y5*y6
      dF(27) = 0.5_ark*((y4*y4)+(y5*y5))
      dF(28) = y4*y5*y6
      dF(29) = 0.5_ark*((y2*y4*y4)+(y3*y5*y5))
      dF(30) = (y2+y3)*y4*y5*y6
      dF(31) = 0.5_ark*((y2*y5*y5)+(y3*y4*y4))
      dF(32) = 0.5_ark*(y1*((y4*y4)+(y5*y5)))
      dF(33) = y1*y4*y5*y6
      dF(34) = 0.5_ark*y2*y3*((y4*y4)+(y5*y5))
      dF(35) = y2*y3*y4*y5*y6
      dF(36) = 0.5_ark*(((y2*y4*y4)+(y3*y5*y5))*y1)
      dF(37) = 0.5_ark*(((y2*y5*y5)+(y3*y4*y4))*y1)
      dF(38) = (y2+y3)*y4*y5*y6*y1
      dF(39) = 0.25_ark*(y1*y1*((y4*y4)+(y5*y5)))
      dF(40) = y1*y1*y4*y5*y6
      dF(41) = (1.0_ark/24.0_ark)*((y4*y4*y4*y4)+(y5*y5*y5*y5))
      dF(42) = (1.0_ark/6.0_ark)*((y4*y4)+(y5*y5))*y4*y5*y6
      dF(43) = 0.25_ark*(y4*y4*y5*y5)
      dF(44) = -0.25_ark*(y4*y4*y5*y5)*sintau

    f = sum(func%params(5:44,irank)*dF(5:44))
    f = f*real(1.0e-11,ark)/real(planck,ark)/real(vellgt,ark)

end subroutine poten_c2h2_strey_mills_ADF



!###############################################################################


subroutine poten_c2h2_morse_ADF(molec, func, internal, f, cart)
  use adf
  implicit none

  type(HM_molec_type), intent(in) :: molec
  type(HM_func_type), intent(in)  :: func
  type(adf_realq), intent(in)     :: internal(molec%nmodes)
  type(adf_realq), intent(out)    :: f(func%rank)
  type(adf_realq), intent(in), optional :: cart(molec%natoms,3)

  integer(ik) :: i, irank, k_ind(6), icoord
  real(ark) :: pd, e1, e2, e4, e6, a1, a2
  type(adf_realq) :: cartesian(molec%natoms,3), r0, r1, r2, r3, cosalpha1, cosalpha2, costau, alpha1, alpha2, tau, l1, l2, n0(3), n1(3), n2(3), v1(3), v2(3), q(6), y(6), vpot

  irank = 1

  ! internal coordinates

  if (trim(molec%coord_transform)=='C2H2_RALPHATAU') then

    r0     = internal(1)
    r1     = internal(2)
    r2     = internal(3)
    alpha1 = internal(4)
    alpha2 = internal(5)
    tau    = internal(6)

  else

    write(out, '(/a,a,a)') 'poten_c2h2_morse_ADF error: coordinate type = "', trim(molec%coord_transform), '" is not supported'
    stop

  endif

  ! expansion functions

  pd = real(pi,ark)/180.0_ark
  e1 = func%params(1,irank)
  e2 = func%params(2,irank)
  e4 = func%params(3,irank)*pd
  e6 = func%params(4,irank)*pd

  a1 = func%params(5,irank)
  a2 = func%params(6,irank)

  q(1) = 1.0_ark-exp(-a1*(r0-e1))
  q(2) = 1.0_ark-exp(-a2*(r1-e2))
  q(3) = 1.0_ark-exp(-a2*(r2-e2))
  q(4) = (alpha1-e4)
  q(5) = (alpha2-e4)
  q(6) = tau

  ! potential

  vpot = 0.0_ark

  do i=7, func%nparams(irank)

    do icoord=1, 5
      if (func%iparams(icoord,i,irank)==0) then
        y(icoord) = 1.0_ark
      elseif (func%iparams(icoord,i,irank)==1) then
        y(icoord) = q(icoord)
      else
        y(icoord) = q(icoord)**func%iparams(icoord,i,irank)
      endif
    enddo

    icoord = 6
    if (func%iparams(icoord,i,irank)==0) then
      y(icoord) = 1.0_ark
    elseif (func%iparams(icoord,i,irank)==1) then
      y(icoord) = cos(tau)*sin(alpha1)*sin(alpha2)
    else
      y(icoord) = (cos(tau)*sin(alpha1)*sin(alpha2))**func%iparams(icoord,i,irank)
    endif

    vpot = vpot + func%params(i,irank)*product(y(1:6))

    if (func%iparams(2,i,irank)/=func%iparams(3,i,irank).or.func%iparams(4,i,irank)/=func%iparams(5,i,irank)) then

      k_ind(2) = func%iparams(3,i,irank)
      k_ind(3) = func%iparams(2,i,irank)
      k_ind(4) = func%iparams(5,i,irank)
      k_ind(5) = func%iparams(4,i,irank)

      do icoord=2, 5
        if (k_ind(icoord)==0) then
          y(icoord) = 1.0_ark
        elseif (k_ind(icoord)==1) then
          y(icoord) = q(icoord)
        else
          y(icoord) = q(icoord)**k_ind(icoord)
        endif
      enddo

      vpot = vpot + func%params(i,irank)*product(y(1:6))

    endif

  enddo

  f = vpot

end subroutine poten_c2h2_morse_ADF
